{"ast":null,"code":"import _slicedToArray from\"/Users/apple/Documents/work/git/nest-react/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState}from'react';import{Button,Col,Container,Modal,Row,Table}from\"react-bootstrap\";import{useHistory}from\"react-router\";import{useMutation,useQuery}from\"@apollo/client\";import{DELETE_USER,GET_USERS}from\"../../process/apollo/GqlData\";import{NotificationService}from\"../../process/services/NotificationService\";export var UsersPage=function UsersPage(){var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState({phone:''}),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];var _useQuery=useQuery(GET_USERS,{variables:{}}),data=_useQuery.data,refetch=_useQuery.refetch;var _useMutation=useMutation(DELETE_USER,{errorPolicy:'all',notifyOnNetworkStatusChange:true,onCompleted:function onCompleted(data){debugger;if(data&&data.delete){console.log(data.delete.success);var notification;if(data.delete.success){notification={variant:'success',message:'User deleted',title:'Success'};refetch();}else{notification={variant:'danger',message:'Error deleting user',title:'Error'};}NotificationService.sendNotification(notification);}}}),_useMutation2=_slicedToArray(_useMutation,2),removeUser=_useMutation2[0],loading=_useMutation2[1].loading;var addNewUser=function addNewUser(){history.push('/users/new');};var editUser=function editUser(user){history.push(\"/users/\".concat(user.id));};var deleteUser=function deleteUser(user){console.log(\"id: \".concat(user.id));setUser(user);handleShow();};var handleClose=function handleClose(){setUser({phone:''});setOpen(false);};var handleShow=function handleShow(){setOpen(true);};var confirmDelete=function confirmDelete(){setOpen(false);removeUser({variables:{id:user.id}});};var dataTable=function dataTable(data){return/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,size:\"sm\",responsive:\"md\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Phone\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:data.users.map(function(user){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:user.id}),/*#__PURE__*/_jsx(\"td\",{children:user.phone}),/*#__PURE__*/_jsxs(\"td\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(Button,{variant:\"link\",color:\"danger\",onClick:function onClick(e){e.preventDefault();deleteUser(user);},children:\"Delete\"}),/*#__PURE__*/_jsx(Button,{variant:\"link\",color:\"primary\",onClick:function onClick(e){e.preventDefault();editUser(user);},children:\"Edit\"})]})]},user.id);})})]});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Container,{fluid:true,children:[/*#__PURE__*/_jsx(Row,{className:\"justify-content-end\",children:/*#__PURE__*/_jsx(Col,{className:\"text-right pt-4 pb-4\",children:/*#__PURE__*/_jsx(Button,{onClick:addNewUser,children:\"Add\"})})}),/*#__PURE__*/_jsx(Row,{className:'justify-content-center',children:/*#__PURE__*/_jsx(Col,{children:data&&data.users&&data.users.length?dataTable(data):/*#__PURE__*/_jsx(\"div\",{className:\"text-center\",children:\"No Data Found\"})})})]}),/*#__PURE__*/_jsxs(Modal,{show:open,onHide:handleClose,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Delete User?\"})}),/*#__PURE__*/_jsx(Modal.Body,{children:\"Delete user with phone # \".concat(user.phone,\"?\")}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:confirmDelete,children:\"Delete\"})]})]})]});};","map":{"version":3,"sources":["/Users/apple/Documents/work/git/nest-react/client/src/ui/pages/Users.tsx"],"names":["React","useState","Button","Col","Container","Modal","Row","Table","useHistory","useMutation","useQuery","DELETE_USER","GET_USERS","NotificationService","UsersPage","history","open","setOpen","phone","user","setUser","variables","data","refetch","errorPolicy","notifyOnNetworkStatusChange","onCompleted","delete","console","log","success","notification","variant","message","title","sendNotification","removeUser","loading","addNewUser","push","editUser","id","deleteUser","handleShow","handleClose","confirmDelete","dataTable","users","map","e","preventDefault","length"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\nimport {Button, Col, Container, Modal, Row, Table} from \"react-bootstrap\";\nimport {useHistory} from \"react-router\";\nimport {useMutation, useQuery} from \"@apollo/client\";\nimport {DELETE_USER, GET_USERS} from \"../../process/apollo/GqlData\";\nimport {IUser} from \"../../process/helpers/Models\";\nimport {NotificationService, IMessage} from \"../../process/services/NotificationService\";\n\nexport const UsersPage = () => {\n\n\tconst history = useHistory();\n\tconst [open, setOpen] = useState<boolean>(false);\n\tconst [user, setUser] = useState<IUser>({phone: ''});\n\n\tconst { data, refetch } = useQuery(GET_USERS, {\n\t\tvariables: {},\n\t});\n\n\tconst [ removeUser, { loading }] = useMutation(DELETE_USER, {\n\t\terrorPolicy: 'all',\n\t\tnotifyOnNetworkStatusChange: true,\n\t\tonCompleted(data) {\n\t\t\tdebugger;\n\t\t\tif (data && data.delete) {\n\t\t\t\tconsole.log(data.delete.success);\n\t\t\t\tlet notification: IMessage;\n\t\t\t\tif (data.delete.success) {\n\t\t\t\t\tnotification = {\n\t\t\t\t\t\tvariant: 'success',\n\t\t\t\t\t\tmessage: 'User deleted',\n\t\t\t\t\t\ttitle: 'Success'\n\t\t\t\t\t}\n\t\t\t\t\trefetch();\n\t\t\t\t} else {\n\t\t\t\t\tnotification = {\n\t\t\t\t\t\tvariant: 'danger',\n\t\t\t\t\t\tmessage: 'Error deleting user',\n\t\t\t\t\t\ttitle: 'Error'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tNotificationService.sendNotification(notification);\n\t\t\t}\n\t\t},\n\n\t})\n\n\tconst addNewUser = () => {\n\t\thistory.push('/users/new');\n\t}\n\n\tconst editUser = (user: IUser) => {\n\t\thistory.push(`/users/${user.id}`);\n\t}\n\n\tconst deleteUser = (user: IUser) => {\n\t\tconsole.log(`id: ${user.id}`);\n\t\tsetUser(user);\n\t\thandleShow();\n\t}\n\n\tconst handleClose = () => {\n\t\tsetUser({phone: ''});\n\t\tsetOpen(false);\n\t}\n\tconst handleShow = () => {\n\t\tsetOpen(true);\n\t}\n\n\tconst confirmDelete = () => {\n\t\tsetOpen(false);\n\t\tremoveUser({variables: {id: user.id}})\n\t}\n\n\tconst dataTable = (data: any) =>\n\t\t(\n\t\t<Table striped bordered hover size=\"sm\" responsive=\"md\">\n\t\t\t<thead>\n\t\t\t<tr>\n\t\t\t\t<th>#</th>\n\t\t\t\t<th>Phone</th>\n\t\t\t\t<th>Actions</th>\n\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t{\n\t\t\t\tdata.users.map( (user: IUser) =>\n\t\t\t\t\t(\n\t\t\t\t\t\t<tr key={user.id}>\n\t\t\t\t\t\t\t<td>{user.id}</td>\n\t\t\t\t\t\t\t<td>{user.phone}</td>\n\t\t\t\t\t\t\t<td className=\"text-right\">\n\t\t\t\t\t\t\t\t<Button variant=\"link\" color=\"danger\" onClick={ (e) => {e.preventDefault(); deleteUser(user)} }>Delete</Button>\n\t\t\t\t\t\t\t\t<Button variant=\"link\" color=\"primary\" onClick={ (e) => {e.preventDefault(); editUser(user)} }>Edit</Button>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t}\n\t\t\t</tbody>\n\n\t\t</Table>\n\t)\n\n\treturn (\n\t\t<div>\n\t\t\t<Container fluid>\n\t\t\t\t<Row className='justify-content-end'>\n\t\t\t\t\t<Col className=\"text-right pt-4 pb-4\">\n\t\t\t\t\t\t<Button onClick={addNewUser}>Add</Button>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Row className={'justify-content-center'}>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t{ (data && data.users && data.users.length) ?\n\t\t\t\t\t\t\tdataTable(data)\n\t\t\t\t\t\t\t: (\n\t\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t\tNo Data Found\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t</Container>\n\n\t\t\t<Modal show={open} onHide={handleClose}>\n\t\t\t\t<Modal.Header closeButton>\n\t\t\t\t\t<Modal.Title>Delete User?</Modal.Title>\n\t\t\t\t</Modal.Header>\n\t\t\t\t<Modal.Body>{`Delete user with phone # ${user.phone}?`}</Modal.Body>\n\t\t\t\t<Modal.Footer>\n\t\t\t\t\t<Button variant=\"secondary\" onClick={handleClose}>\n\t\t\t\t\t\tClose\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button variant=\"danger\" onClick={confirmDelete}>\n\t\t\t\t\t\tDelete\n\t\t\t\t\t</Button>\n\t\t\t\t</Modal.Footer>\n\t\t\t</Modal>\n\t\t</div>\n\t);\n};\n"]},"metadata":{},"sourceType":"module"}