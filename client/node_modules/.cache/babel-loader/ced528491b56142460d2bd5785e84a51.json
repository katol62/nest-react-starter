{"ast":null,"code":"import _classCallCheck from\"/Users/apple/Documents/work/git/nest-react/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/apple/Documents/work/git/nest-react/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import PersistentStorage from\"./Storage\";import{Constants}from\"../helpers/Models\";import{isExpired}from\"react-jwt\";import{isLoggedInVar,loggedUserVar,tokenVar}from\"../apollo/GqlClient\";var Auth=/*#__PURE__*/function(){function Auth(){_classCallCheck(this,Auth);this.storage=PersistentStorage.instance;}_createClass(Auth,[{key:\"logOut\",value:function logOut(){this.storage.clear();loggedUserVar(null);tokenVar(null);isLoggedInVar(false);}},{key:\"authorized\",get:function get(){var token=tokenVar();if(token&&!isExpired(token)){return true;}return false;}},{key:\"initialAuthorized\",get:function get(){var token=this.storage.getItem(Constants.TOKEN);if(token&&!isExpired(token)){return true;}return false;}},{key:\"initialToken\",get:function get(){var token=this.storage.getItem(Constants.TOKEN);return token?token:null;}},{key:\"token\",get:function get(){return tokenVar();},set:function set(token){if(token){this.storage.setItem(Constants.TOKEN,token);}else{this.storage.removeItem(Constants.TOKEN);}tokenVar(token);}},{key:\"initialUser\",get:function get(){var user=this.storage.getItem(Constants.USER);return user?user:null;}},{key:\"user\",get:function get(){return loggedUserVar();},set:function set(user){if(user){this.storage.setItem(Constants.USER,user);}else{this.storage.removeItem(Constants.USER);}}}],[{key:\"instance\",get:function get(){if(!this._instance){this._instance=new Auth();}return this._instance;}}]);return Auth;}();Auth._instance=null;export{Auth as default};","map":{"version":3,"sources":["/Users/apple/Documents/work/git/nest-react/client/src/process/store/Auth.ts"],"names":["PersistentStorage","Constants","isExpired","isLoggedInVar","loggedUserVar","tokenVar","Auth","storage","instance","clear","token","getItem","TOKEN","setItem","removeItem","user","USER","_instance"],"mappings":"8UAAA,MAAOA,CAAAA,iBAAP,KAA8B,WAA9B,CACA,OAAQC,SAAR,KAAwB,mBAAxB,CACA,OAAQC,SAAR,KAAwB,WAAxB,CACA,OAAQC,aAAR,CAAuBC,aAAvB,CAAsCC,QAAtC,KAAqD,qBAArD,C,GAEqBC,CAAAA,I,yBAMpB,eAAc,iCAJNC,OAIM,CAJIP,iBAAiB,CAACQ,QAItB,CACb,C,wDAyBqB,CACrB,KAAKD,OAAL,CAAaE,KAAb,GACAL,aAAa,CAAC,IAAD,CAAb,CACAC,QAAQ,CAAC,IAAD,CAAR,CACAF,aAAa,CAAC,KAAD,CAAb,CACA,C,sCArBgC,CAChC,GAAMO,CAAAA,KAAK,CAAGL,QAAQ,EAAtB,CACA,GAAIK,KAAK,EAAI,CAACR,SAAS,CAACQ,KAAD,CAAvB,CAAgC,CAC/B,MAAO,KAAP,CACA,CACD,MAAO,MAAP,CACA,C,6CAEuC,CACvC,GAAMA,CAAAA,KAAK,CAAG,KAAKH,OAAL,CAAaI,OAAb,CAAqBV,SAAS,CAACW,KAA/B,CAAd,CACA,GAAIF,KAAK,EAAI,CAACR,SAAS,CAACQ,KAAD,CAAvB,CAAgC,CAC/B,MAAO,KAAP,CACA,CACD,MAAO,MAAP,CACA,C,wCASwC,CACxC,GAAMA,CAAAA,KAAK,CAAG,KAAKH,OAAL,CAAaI,OAAb,CAAqBV,SAAS,CAACW,KAA/B,CAAd,CACA,MAAOF,CAAAA,KAAK,CAAGA,KAAH,CAAW,IAAvB,CACA,C,iCAEiC,CACjC,MAAOL,CAAAA,QAAQ,EAAf,CACA,C,kBACgBK,K,CAAsB,CACtC,GAAIA,KAAJ,CAAW,CACV,KAAKH,OAAL,CAAaM,OAAb,CAAqBZ,SAAS,CAACW,KAA/B,CAAsCF,KAAtC,EACA,CAFD,IAEO,CACN,KAAKH,OAAL,CAAaO,UAAb,CAAwBb,SAAS,CAACW,KAAlC,EACA,CACDP,QAAQ,CAACK,KAAD,CAAR,CACA,C,uCAE6B,CAC7B,GAAMK,CAAAA,IAAI,CAAG,KAAKR,OAAL,CAAaI,OAAb,CAAqBV,SAAS,CAACe,IAA/B,CAAb,CACA,MAAOD,CAAAA,IAAI,CAAGA,IAAH,CAAU,IAArB,CACA,C,gCAEsB,CACtB,MAAOX,CAAAA,aAAa,EAApB,CACA,C,kBAEeW,I,CAAW,CAC1B,GAAIA,IAAJ,CAAU,CACT,KAAKR,OAAL,CAAaM,OAAb,CAAqBZ,SAAS,CAACe,IAA/B,CAAqCD,IAArC,EACA,CAFD,IAEO,CACN,KAAKR,OAAL,CAAaO,UAAb,CAAwBb,SAAS,CAACe,IAAlC,EACA,CAED,C,sCA/DkC,CAClC,GAAI,CAAC,KAAKC,SAAV,CAAqB,CACpB,KAAKA,SAAL,CAAiB,GAAIX,CAAAA,IAAJ,EAAjB,CACA,CACD,MAAO,MAAKW,SAAZ,CACA,C,oBAdmBX,I,CAIbW,S,CAAyB,I,QAJZX,I","sourcesContent":["import PersistentStorage from \"./Storage\";\nimport {Constants} from \"../helpers/Models\";\nimport {isExpired} from \"react-jwt\";\nimport {isLoggedInVar, loggedUserVar, tokenVar} from \"../apollo/GqlClient\";\n\nexport default class Auth {\n\n\tprivate storage = PersistentStorage.instance;\n\n\tstatic _instance: Auth | null = null;\n\n\tconstructor() {\n\t}\n\n\tpublic static get instance(): Auth {\n\t\tif (!this._instance) {\n\t\t\tthis._instance = new Auth()\n\t\t}\n\t\treturn this._instance\n\t}\n\n\tpublic get authorized(): boolean {\n\t\tconst token = tokenVar();\n\t\tif (token && !isExpired(token)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic get initialAuthorized(): boolean {\n\t\tconst token = this.storage.getItem(Constants.TOKEN);\n\t\tif (token && !isExpired(token)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic logOut(): void {\n\t\tthis.storage.clear();\n\t\tloggedUserVar(null);\n\t\ttokenVar(null);\n\t\tisLoggedInVar(false);\n\t}\n\n\tpublic get initialToken(): string | null {\n\t\tconst token = this.storage.getItem(Constants.TOKEN);\n\t\treturn token ? token : null\n\t}\n\n\tpublic get token(): string | null {\n\t\treturn tokenVar()\n\t}\n\tpublic set token(token: string | null) {\n\t\tif (token) {\n\t\t\tthis.storage.setItem(Constants.TOKEN, token as string);\n\t\t} else {\n\t\t\tthis.storage.removeItem(Constants.TOKEN);\n\t\t}\n\t\ttokenVar(token);\n\t}\n\n\tpublic get initialUser(): any {\n\t\tconst user = this.storage.getItem(Constants.USER);\n\t\treturn user ? user : null;\n\t}\n\n\tpublic get user(): any {\n\t\treturn loggedUserVar()\n\t}\n\n\tpublic set user(user: any) {\n\t\tif (user) {\n\t\t\tthis.storage.setItem(Constants.USER, user);\n\t\t} else {\n\t\t\tthis.storage.removeItem(Constants.USER);\n\t\t}\n\n\t}\n\n}\n"]},"metadata":{},"sourceType":"module"}